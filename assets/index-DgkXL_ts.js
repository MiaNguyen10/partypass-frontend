import{r as e,j as t,a}from"./react-BRShYvXP.js";import{c as i}from"./react-dom-3D_avoTu.js";import{u as s,a as r,P as n}from"./react-redux-BTDEv3mD.js";import{u as l,N as o,O as d,a as c,L as u,b as m,c as p,R as h}from"./react-router-CMAZMH0K.js";import{P as x}from"./prop-types-B81A7O0o.js";import{j as f}from"./jwt-decode-sPk1YpsG.js";import{s as j,C as g,S as v,a as b,T as k,B as _,F as y,b as w,c as C,I as N,d as P,V as S,e as I,f as E,L as R,g as T,h as q,A as W,i as D,M as A,D as L,j as $,k as V,u as F,l as Y,m as M,n as U,o as H,p as z,q as O,r as B,t as G,v as J,w as K,x as Z,P as Q,y as X,z as ee,E as te,G as ae,H as ie,R as se,J as re,K as ne,N as le,O as oe,Q as de,U as ce,W as ue,X as me,Y as pe,Z as he,_ as xe}from"./@mui-3-Mu00Wh.js";import{c as fe,a as je,b as ge}from"./@reduxjs-DA_YfTog.js";import{a as ve}from"./axios-pWxfYeV7.js";import{o as be}from"./@hookform-DuY6KiOQ.js";import{C as ke,u as _e,F as ye}from"./react-hook-form-Tf7WVXn4.js";import{c as we,a as Ce,b as Ne,d as Pe,e as Se,f as Ie,g as Ee}from"./yup-BgK6irwM.js";import{u as Re,n as Te}from"./@emotion-DV9lSoNT.js";import{d as qe}from"./dayjs-BtAI-RA9.js";import"./cookie-Bxb2uFw8.js";import"./scheduler-CQYGjB7w.js";import"./use-sync-external-store-BaE4T82b.js";import"./clsx-BeLtu-UY.js";import"./react-transition-group-CwOPPqPr.js";import"./@babel-CcRS86ir.js";import"./dom-helpers-BmWjwk_c.js";import"./react-is-Ck5vv-3d.js";import"./@popperjs-_iZV8NMP.js";import"./redux-C5Huw2aR.js";import"./immer-DH0LoexQ.js";import"./redux-thunk-B3S1iNVp.js";import"./property-expr-DJkEfuIG.js";import"./tiny-case-CbcIhwGY.js";import"./toposort-DsYyS2xV.js";import"./hoist-non-react-statics-CPjjL7Uz.js";import"./stylis-CWkYTb2H.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const We=e.createContext(),De=({children:a})=>{const i=e.useCallback(((e,t)=>t.includes(e)),[]);return t.jsx(We.Provider,{value:{isAllowedTo:i},children:a})};De.propTypes={children:x.node.isRequired};const Ae={image:["jpg","gif","png","jpeg","svg","webp"]},Le=[{id:0,value:"App User"},{id:1,value:"System Admin"},{id:2,value:"Institutional Admin"},{id:3,value:"Institutional Staff"}],$e=[{id:0,value:"Disabled"},{id:1,value:"Active"}],Ve=[{id:0,value:"Disabled"},{id:1,value:"Active"}],Fe=[{id:0,value:"Purchased"},{id:1,value:"Entered"},{id:2,value:"Checked out"}],Ye="idle",Me="pending",Ue="succeeded",He="failed",ze={loginPath:"/login",homePagePath:"/",ticketsPath:"/tickets",ticketDetailPath:"/tickets/:id",editTicketPath:"/tickets/:id/edit",addTicketPath:"/tickets/add",ticketsPathForInstitution:"/tickets_institution",editTicketPathForInstitution:"/tickets_institution/:id/edit",addTicketPathForInstitution:"/tickets_institution/add",ticketPathForInstitution:"/tickets_institution/:id",usersPath:"/users",userDetailPath:"/users/:id",editUserPath:"/users/:id/edit",addUsersPath:"/users/add",institutionsPath:"/institutions",institutionDetailPath:"/institutions/:id",lockerForInstitutionPath:"/institutions/:id/lockers",editInstitutionPath:"/institutions/:id/edit",addInstitutionPath:"/institutions/add",lockersPath:"/lockers",lockerDetailPath:"/lockers/:id",editLockerPath:"/lockers/:id/edit",addLockerPath:"/lockers/add",purchasePath:"/purchase",purchaseDetailPath:"/purchase/:id",purchasePathForInstitution:"/purchase_institution",purchaseDetailPathForInstitution:"/purchase_institution/:id",accessDenied:"/access-denied"},Oe=()=>{const e=l();return sessionStorage.getItem("token")?t.jsx(d,{}):t.jsx(o,{to:`${ze.loginPath}`,state:{from:e},replace:!0})},Be=({permissionRoles:e})=>{const a=l(),{role:i}=f(sessionStorage.getItem("token"));return i&&Array.isArray(e)?e.includes(i)?t.jsx(d,{}):t.jsx(o,{to:`${ze.accessDenied}`,state:{from:a},replace:!0}):(console.error("Invalid role or permissionRoles:",{role:i,permissionRoles:e}),t.jsx(o,{to:`${ze.accessDenied}`,state:{from:a},replace:!0}))};Be.propTypes={permissionRoles:x.arrayOf(x.number).isRequired};const Ge=()=>t.jsx("section",{className:"bg-white dark:bg-gray-900",children:t.jsx("div",{className:"py-8 px-4 mx-auto max-w-screen-xl lg:py-16 lg:px-6",children:t.jsxs("div",{className:"mx-auto max-w-screen-sm text-center",children:[t.jsx("p",{className:"mb-4 text-3xl tracking-tight font-bold text-gray-900 md:text-4xl dark:text-white",children:"Access Denied"}),t.jsx("p",{className:"mb-4 text-lg font-light text-gray-500 dark:text-gray-400",children:"You do not have permission to view this page."}),t.jsx("a",{href:"/",className:"inline-flex text-gray-900 bg-primary-600 hover:bg-primary-800 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:focus:ring-primary-900 my-4",children:"Back to Homepage"})]})})}),Je=ve.create({baseURL:"https://partypass-server.onrender.com",headers:{"Content-Type":"application/json",Accept:"*/*"}});Je.interceptors.request.use((e=>{const t=sessionStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e))),Je.interceptors.response.use((e=>e),(e=>(e.response?console.error("Response Error:",e.response.data):e.request?console.error("No response received:",e.request):console.error("Request Error:",e.message),Promise.reject(e))));const Ke=fe("auth/authenticate",(async({email:e,password:t},{rejectWithValue:a})=>{try{return(await Je.post("/api/v1/users/login",{email:e,password:t})).data}catch(i){if(!i.response)throw i;return a(i.response.data)}})),Ze=je({name:"auth",initialState:{isAuthenticated:!1,user:null,loading:Ye,error:null},reducers:{logout:e=>{e.isAuthenticated=!1,e.user=null,sessionStorage.removeItem("token")}},extraReducers:e=>{e.addCase(Ke.pending,(e=>{e.loading=Me})).addCase(Ke.fulfilled,((e,t)=>{e.loading=Ue,e.isAuthenticated=!0,e.user=t.payload,e.error=null})).addCase(Ke.rejected,((e,t)=>{e.loading=He,e.isAuthenticated=!1,e.user=null,e.error=t.error.message}))}}),{logout:Qe}=Ze.actions,Xe=Ze.reducer,et=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{6,}$/i,tt=j(g)((({theme:e})=>({display:"flex",flexDirection:"column",alignSelf:"center",width:"100%",padding:e.spacing(4),gap:e.spacing(2),margin:"auto",[e.breakpoints.up("sm")]:{maxWidth:"450px"},boxShadow:"hsla(220, 30%, 5%, 0.05) 0px 5px 15px 0px, hsla(220, 25%, 10%, 0.05) 0px 15px 35px -5px",...e.applyStyles("dark",{boxShadow:"hsla(220, 30%, 5%, 0.5) 0px 5px 15px 0px, hsla(220, 25%, 10%, 0.08) 0px 15px 35px -5px"})}))),at=j(v)((({theme:e})=>({minHeight:"100%",padding:e.spacing(2),[e.breakpoints.up("sm")]:{padding:e.spacing(4)},"&::before":{content:'""',display:"block",position:"absolute",zIndex:-1,inset:0,backgroundImage:"radial-gradient(ellipse at 50% 50%, hsl(210, 100%, 97%), hsl(0, 0%, 100%))",backgroundRepeat:"no-repeat",...e.applyStyles("dark",{backgroundImage:"radial-gradient(at 50% 50%, hsla(210, 100%, 16%, 0.5), hsl(220, 30%, 5%))"})}})));function it(){const a=c(),i=s(),[r,n]=e.useState(!1),[l,o]=e.useState(""),[d,u]=e.useState(!1),[m,p]=e.useState(""),[h,x]=e.useState(!1),[f,j]=e.useState(""),g=()=>{const e=document.getElementById("username").value,t=document.getElementById("password").value;let a=!0;return e?(n(!1),o("")):(n(!0),o("Please enter username"),a=!1),t&&et.test(t)?(u(!1),p("")):(u(!0),p("Password must be at least 6 characters long, have at least one uppercase letter, one lowercase letter, one number, and one special character."),a=!1),a};return t.jsxs(t.Fragment,{children:[t.jsx(b,{enableColorScheme:!0}),t.jsx(at,{direction:"column",justifyContent:"space-between",children:t.jsxs(tt,{variant:"outlined",children:[t.jsx(k,{component:"h1",variant:"h4",sx:{width:"100%",fontSize:"clamp(2rem, 10vw, 2.15rem)"},children:"Sign in"}),t.jsxs(_,{component:"form",onSubmit:e=>{if(e.preventDefault(),g()){const t=new FormData(e.currentTarget),s=t.get("username"),r=t.get("password");i(Ke({email:s,password:r})).unwrap().then((e=>{sessionStorage.setItem("token",e.token),a("/")})).catch((e=>{j(`Login failed. ${e.message}`)}))}},noValidate:!0,sx:{display:"flex",flexDirection:"column",width:"100%",gap:2},children:[t.jsxs(y,{children:[t.jsx(w,{htmlFor:"username",children:"Username"}),t.jsx(C,{error:r,helperText:l,id:"username",type:"username",name:"username",placeholder:"Username",autoFocus:!0,required:!0,fullWidth:!0,variant:"outlined",color:r?"error":"primary"})]}),t.jsxs(y,{children:[t.jsx(_,{sx:{display:"flex",justifyContent:"space-between"},children:t.jsx(w,{htmlFor:"password",children:"Password"})}),t.jsx(C,{error:d,helperText:m,name:"password",placeholder:"Password",id:"password",autoComplete:"current-password",required:!0,fullWidth:!0,variant:"outlined",color:d?"error":"primary",type:h?"text":"password",slotProps:{input:{endAdornment:t.jsx(N,{position:"end",children:t.jsx(P,{"aria-label":h?"hide the password":"display the password",onClick:()=>x((e=>!e)),edge:"end",children:h?t.jsx(S,{}):t.jsx(I,{})})})}}})]}),f&&t.jsx(k,{color:"error",variant:"body2",children:f}),t.jsx(E,{type:"submit",fullWidth:!0,variant:"contained",children:"Sign in"})]})]})})]})}const st=({allowedRoles:a,children:i})=>{var s;const{isAllowedTo:r}=e.useContext(We),n=sessionStorage.getItem("token");if(!n)return t.jsx(it,{});let l=null;try{const e=f(n);if(l=null==(s=Le.find((t=>t.id===e.role)))?void 0:s.value,!l)return console.error("Invalid role detected!"),t.jsx(Ge,{})}catch(o){return console.error("Token decoding error:",o),t.jsx(Ge,{})}return r(l,a)?i?t.jsx(t.Fragment,{children:i}):t.jsx(d,{}):i?null:t.jsx(Ge,{})};st.propTypes={allowedRoles:x.arrayOf(x.string).isRequired,children:x.node};const rt=j(E)((()=>({backgroundColor:"transparent",backgroundImage:"linear-gradient(#fff, #f5f5fa)",border:"0 solid #003dff",borderRadius:"9999px",boxShadow:"rgba(37, 44, 97, .15) 0 4px 11px 0, rgba(93, 100, 148, .2) 0 1px 3px 0",boxSizing:"border-box",color:"#484c7a",cursor:"pointer",display:"inline-block",fontFamily:'Hind, system-ui, BlinkMacSystemFont, -apple-system, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif',fontWeight:600,margin:"4px",padding:"16px 24px",textAlign:"center",textDecoration:"inherit",textWrap:"nowrap",transition:"all .2s ease-out",transitionBehavior:"normal",whiteSpaceCollapse:"collapse",lineHeight:1.15,"&:hover":{boxShadow:"rgba(37, 44, 97, .15) 0 8px 22px 0, rgba(93, 100, 148, .2) 0 4px 6px 0"},"&:disabled":{cursor:"not-allowed",opacity:.5},"@media (min-width: 576px)":{paddingBottom:"10px",paddingTop:"10px"}}))),nt=j("main")((({theme:e})=>({flexGrow:1,padding:e.spacing(3),marginLeft:10,transition:e.transitions.create(["margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"@media (max-width: 1280px)":{marginLeft:0}}))),lt=j("nav")((()=>({width:200,flexShrink:0,"@media (max-width: 1280px)":{width:0}}))),ot=({children:a})=>{const i=c(),r=s(),[n,l]=e.useState(!1),{name:o,institution_id:d}=f(sessionStorage.getItem("token")),m=()=>{l(!n)},p=t.jsx("div",{children:t.jsxs(R,{children:[t.jsx(st,{allowedRoles:[Le[1].value],children:["Home","Tickets","Users","Institutions","Purchase"].map((e=>t.jsx(T,{component:u,to:"Home"===e?"/":`/${e.toLowerCase()}`,children:t.jsx(q,{primary:e})},e)))}),t.jsx(st,{allowedRoles:[Le[2].value],children:["Home","Tickets","Institution","Lockers","Purchase"].map((e=>t.jsx(T,{component:u,to:"Home"===e?"/":"Tickets"===e?ze.ticketsPathForInstitution:"Institution"===e?`${ze.institutionsPath}/${d}`:"Lockers"===e?ze.lockersPath:"Purchase"===e?ze.purchasePathForInstitution:"/",children:t.jsx(q,{primary:e})},e)))})]})});return t.jsxs("div",{className:"flex h-screen",children:[t.jsx(b,{}),t.jsx(W,{position:"fixed",style:{zIndex:1201},children:t.jsx(D,{children:t.jsxs("div",{className:"flex justify-between w-full",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(P,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:m,sx:{display:{xl:"none"}},children:t.jsx(A,{})}),t.jsx(k,{variant:"h6",noWrap:!0,children:"Party Pass Admin Page"})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx(k,{noWrap:!0,children:o}),t.jsx(rt,{onClick:()=>{r(Qe()),i(ze.loginPath)},children:"Log out"})]})]})})}),t.jsxs(lt,{children:[t.jsxs(L,{variant:"temporary",open:n,onClose:m,className:"xl:hidden",ModalProps:{keepMounted:!0},PaperProps:{style:{width:200}},children:[t.jsx(D,{}),p]}),t.jsxs(L,{variant:"permanent",className:"hidden xl:block",open:!0,PaperProps:{style:{width:200}},children:[t.jsx(D,{}),p]})]}),t.jsxs(nt,{children:[t.jsx(D,{}),a]})]})};ot.propTypes={children:x.node.isRequired};const dt=()=>t.jsx(t.Fragment,{children:t.jsx(ot,{children:t.jsx("h1",{children:"Home Page"})})}),ct=({files:e,width:i,height:s})=>{const[r,n]=a.useState([]);return a.useEffect((()=>{if(!Array.isArray(e))return void console.error("files prop is not an array:",e);const t=[];e.forEach((a=>{const i=new FileReader;i.readAsDataURL(a),i.onload=()=>{const s=a&&"image"===a.type.split("/")[0];t.push(s?i.result:"/default.svg"),t.length===e.length&&n(t)}}))}),[e]),t.jsx("div",{className:"flex flex-row flex-wrap",children:r.map(((e,a)=>t.jsx("div",{className:"px-2 pb-2 relative",children:t.jsx("img",{src:e,alt:"Preview",width:i,height:s})},a)))})};function ut({mapUrl:e}){return t.jsx(_,{className:"w-full h-64 md:h-96 overflow-hidden rounded-lg shadow-lg",sx:{borderRadius:2,border:1,borderColor:"grey.300",mt:2},children:t.jsx("iframe",{title:"Map",src:e,className:"w-full h-full",allowFullScreen:!0,loading:"lazy"})})}ct.propTypes={files:x.arrayOf(x.instanceOf(File)).isRequired,width:x.oneOfType([x.number,x.string]),height:x.oneOfType([x.number,x.string]),handleRemove:x.func},ut.propTypes={mapUrl:x.string.isRequired};const mt=({handleSubmit:e,onSubmit:a,control:i,formErrors:s,watch:r,setValue:n,fileInputRef:l})=>{const o=r("cover_photo"),d=Ae["image"].map((e=>`.${e}`)).toString();return t.jsxs("form",{onSubmit:e(a),className:"grid gap-4 py-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(ke,{name:"name",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.name),helperText:null==(i=null==s?void 0:s.name)?void 0:i.message,label:"Institution Name",variant:"outlined"})}}),t.jsx(ke,{name:"email",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.email),helperText:null==(i=null==s?void 0:s.email)?void 0:i.message,label:"Email",variant:"outlined"})}})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(ke,{name:"phone",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.phone),helperText:null==(i=null==s?void 0:s.phone)?void 0:i.message,label:"Phone",variant:"outlined"})}}),t.jsx(ke,{name:"address",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.address),helperText:null==(i=null==s?void 0:s.address)?void 0:i.message,label:"Address",variant:"outlined"})}})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx(ut,{mapUrl:r("map_location")}),t.jsxs("div",{className:"flex flex-col space-y-2",children:[t.jsx(ke,{name:"map_location",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.map_location),helperText:null==(i=null==s?void 0:s.map_location)?void 0:i.message,label:"Map location",variant:"outlined",multiline:!0})}}),t.jsx(E,{variant:"contained",onClick:()=>(e=>{if(e.startsWith("http")||!e.includes("<iframe"))return e;const t=e.match(/src="([^"]+)"/);n("map_location",t?t[1]:null)})(r("map_location")),children:"Extract URL"})]})]}),t.jsx(ke,{name:"details",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.details),helperText:null==(i=null==s?void 0:s.details)?void 0:i.message,label:"Detail",variant:"outlined",multiline:!0})}}),t.jsx(ke,{name:"status",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{select:!0,value:a,onChange:e,error:!!(null==s?void 0:s.status),helperText:null==(i=null==s?void 0:s.status)?void 0:i.message,label:"Institution status",variant:"outlined",children:$e.map((e=>t.jsx($,{value:e.value,children:e.value},e.id)))})}}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"button label",htmlFor:"cover_photo",children:t.jsxs("span",{children:["Upload cover photo (Validate file: [",d,"])"]})}),t.jsx(ke,{name:"cover_photo",control:i,render:({field:e})=>t.jsx("input",{id:"cover_photo",type:"file",accept:d,ref:l,onChange:t=>{const a=Array.from(t.target.files);e.onChange(a),n("cover_photo",a)}})}),o&&(Array.isArray(o)&&o.length>0?t.jsx(ct,{className:{margin:"auto"},width:300,height:"auto",files:o}):t.jsx("img",{src:r("cover_photo"),alt:"cover_photo",width:300,height:"auto"}))]}),t.jsx("div",{className:"grid gap-2",children:t.jsx(ke,{name:"video_link",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{label:"Video link",variant:"outlined",value:a,onChange:t=>e(t.target.value),error:!!(null==s?void 0:s.video_link),helperText:null==(i=null==s?void 0:s.video_link)?void 0:i.message})}})}),t.jsx(E,{type:"submit",variant:"contained",children:"Save institution"})]})};mt.propTypes={handleSubmit:x.func.isRequired,onSubmit:x.func.isRequired,control:x.object.isRequired,formErrors:x.object,watch:x.func.isRequired,setValue:x.func.isRequired,fileInputRef:x.object.isRequired};const pt=we().shape({name:Ce().required("Name is required"),email:Ce().matches(/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/i,"Email is not valid").required("Email is required"),phone:Ce().matches(/^\d{10,14}$/i,"Phone is not valid").required("Phone is required"),address:Ce().required("Address is required"),map_location:Ce(),details:Ce(),video_link:Ce(),status:Ce().required("Status is required")}),ht=ve.create({baseURL:"https://partypass-server.onrender.com",headers:{"Content-Type":"multipart/form-data",Accept:"*/*"}});ht.interceptors.request.use((e=>{const t=sessionStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e))),ht.interceptors.response.use((e=>e),(e=>(e.response?console.error("Response Error:",e.response.data):e.request?console.error("No response received:",e.request):console.error("Request Error:",e.message),Promise.reject(e))));const xt=fe("institution/getInstitutionList",(async(e,{rejectWithValue:t})=>{try{return(await Je.get("/api/v1/institute/list")).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),ft=fe("institution/getInstitutionById",(async(e,{rejectWithValue:t})=>{try{return(await Je.get(`/api/v1/institute/${e}`)).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),jt=fe("institution/updateInstitution",(async({institutionData:e,institution_id:t},{rejectWithValue:a})=>{try{return(await ht.patch(`/api/v1/institute/update/${t}`,e)).data}catch(i){if(!i.response)throw i;return a(i.response.data)}})),gt=fe("institution/createInstitution",(async({institutionData:e},{rejectWithValue:t})=>{try{return(await ht.post("/api/v1/institute/create",e)).data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),vt=fe("institution/deleteInstitution",(async(e,{rejectWithValue:t})=>{try{return(await Je.delete(`/api/v1/institute/delete/${e}`)).data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),bt=fe("institution/getTicketListFromInstitution",(async(e,{rejectWithValue:t})=>{try{return(await Je.get(`/api/v1/institute/${e}/ticketlist`)).data.data[0].Tickets}catch(a){if(!a.response)throw a;return t(a.response.data)}})),kt=()=>{const a=c(),i=s(),r=e.useRef(null),{handleSubmit:n,control:l,formState:{errors:o},reset:d,setValue:u,watch:m}=_e({resolver:be(pt),defaultValues:{name:"",email:"",phone:"",address:"",map_location:"",details:"",cover_photo:"",video_link:"",status:""}});return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Add institution"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(ze.institutionsPath),children:"Go back Institutions page"})]}),t.jsx(mt,{handleSubmit:n,onSubmit:e=>{const t=new FormData;t.append("name",e.name),t.append("email",e.email),t.append("phone",e.phone),t.append("address",e.address),t.append("map_location",e.map_location),t.append("details",e.details),t.append("video_link",e.video_link),t.append("status","Active"===e.status?1:0),e.cover_photo&&e.cover_photo[0]&&t.append("cover_photo",e.cover_photo[0]),i(gt({institutionData:t})).then((()=>{r.current&&(r.current.value=null)})),d()},control:l,formErrors:o,watch:m,setValue:u,fileInputRef:r})]})},_t=je({name:"institution",initialState:{institutions:[],tickets:[],institution:{institution_id:"",name:"",email:"",phone:"",address:"",map_location:"",status:"",details:"",cover_photo:"",video_link:""},loading:Ye,error:null},reducers:{},extraReducers:e=>{e.addCase(xt.pending,(e=>{e.loading=Me})).addCase(xt.fulfilled,((e,t)=>{e.loading=Ue,e.institutions=t.payload.map((e=>({institution_id:e.institution_id,name:e.name,email:e.email,phone:e.phone,address:e.address,map_location:e.map_location,status:e.status,details:e.details,cover_photo:e.cover_photo,video_link:e.video_link}))),e.error=null})).addCase(xt.rejected,((e,t)=>{e.loading=He,e.institutions=[],e.error=t.error.message})).addCase(ft.pending,(e=>{e.loading=Me})).addCase(ft.fulfilled,((e,t)=>{e.loading=Ue,e.institution={...e.institution,...t.payload},e.error=null})).addCase(ft.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(jt.pending,(e=>{e.loading=Me})).addCase(jt.fulfilled,((e,t)=>{e.loading=Ue,e.institutions=e.institutions.map((e=>e.id===t.payload.institution_id?t.payload:e)),e.error=null})).addCase(jt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(gt.pending,(e=>{e.loading=Me})).addCase(gt.fulfilled,((e,t)=>{e.loading=Ue,e.institutions.push(t.payload),e.error=null})).addCase(gt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(vt.pending,(e=>{e.loading=Me})).addCase(vt.fulfilled,((e,t)=>{e.loading=Ue,e.institutions=e.institutions.filter((e=>e.id!==t.payload.institution_id)),e.error=null})).addCase(vt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(bt.pending,(e=>{e.loading=Me})).addCase(bt.fulfilled,((e,t)=>{e.loading=Ue,e.tickets=t.payload,e.error=null})).addCase(bt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message}))}}).reducer,yt=e=>e.institution.institutions,wt=e=>e.institution.institution,Ct=e=>e.institution.tickets,Nt=()=>{const{id:a}=m(),i=c(),n=s(),l=r(wt),o=e.useRef(null);e.useEffect((()=>{n(ft(a))}),[n,a]);const{handleSubmit:d,control:u,formState:{errors:p},reset:h,watch:x,setValue:f}=_e({resolver:be(pt),defaultValues:{name:"",email:"",phone:"",address:"",map_location:"",details:"",cover_photo:"",video_link:"",status:""}});e.useEffect((()=>{l&&h({name:l.name||"",email:l.email||"",phone:l.phone||"",address:l.address||"",map_location:l.map_location||"",details:l.details||"",cover_photo:l.cover_photo||"",video_link:l.video_link||"",status:0===l.status?$e[0].value:$e[1].value||""})}),[l]);return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Edit ticket"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>i(ze.institutionsPath),children:"Go back Institutions page"})]}),t.jsx(mt,{handleSubmit:d,onSubmit:e=>{const t=new FormData;t.append("name",e.name),t.append("email",e.email),t.append("phone",e.phone),t.append("address",e.address),t.append("map_location",e.map_location),t.append("details",e.details),t.append("video_link",e.video_link),t.append("status","Active"===e.status?1:0),e.cover_photo&&(e.cover_photo[0]instanceof File?t.append("cover_photo",e.cover_photo[0]):"string"==typeof e.cover_photo&&t.append("cover_photo",e.cover_photo)),n(jt({institutionData:t,institution_id:a})).then((()=>{n(ft(a)),o.current&&(o.current.value=null)})).catch((e=>{console.error("Update Error:",e)}))},control:u,formErrors:p,watch:x,setValue:f,fileInputRef:o})]})},Pt=()=>{const a=c(),i=s(),{id:n}=m(),l=r(wt);return e.useEffect((()=>{i(ft(n))}),[i,n]),t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Institution details"}),t.jsx(st,{allowedRoles:[Le[1].value],children:t.jsxs("div",{className:"flex flex-row",children:[t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(ze.institutionsPath),children:"Go back Institutions page"}),t.jsx("p",{className:"px-3",children:" | "}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(`${ze.institutionsPath}/${n}/edit`),children:"Edit"})]})})]}),t.jsxs("div",{className:"grid gap-4 py-3",children:[t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Institution name:"}),t.jsx("p",{className:"px-2",children:l.name})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Email:"}),t.jsx("p",{className:"px-2",children:l.email})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Phone:"}),t.jsx("p",{className:"px-2",children:l.phone})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Address:"}),t.jsx("p",{className:"px-2",children:l.address})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Details:"}),t.jsx("p",{className:"px-2",children:l.details})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Status:"}),t.jsx("p",{className:"px-2",children:0===l.status?$e[0].value:$e[1].value})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Map location:"}),l.map_location?t.jsx(ut,{mapUrl:l.map_location}):t.jsx("p",{className:"px-2",children:"No map location"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"font-bold",children:"Images:"}),t.jsx("div",{className:"px-2",children:null===l.cover_photo?t.jsx("p",{children:"No cover photo"}):t.jsx("img",{src:l.cover_photo,alt:"cover_photo",width:300,height:"auto"})})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Video link:"}),t.jsx("div",{className:"px-2 flex flex-col",children:l.video_link?t.jsx(V,{href:l.video_link,underline:"hover",target:"_blank",rel:"noopener noreferrer",children:t.jsx("p",{className:"text-cyan-600 italic font-bold",children:"Press here to open video"})}):t.jsx("p",{children:"No video"})})]}),t.jsx(st,{allowedRoles:[Le[1].value],children:t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Locker page:"}),t.jsx(V,{href:ze.lockerForInstitutionPath.replace(":id",n),underline:"hover",rel:"noopener noreferrer",className:"px-2",children:t.jsx("p",{className:"text-cyan-600 italic font-bold",children:"Press here to open Locker page for this institution"})})]})})]})]})},St=j(E)((()=>({height:"35px",boxShadow:"rgba(60, 64, 67, 0.3) 0px 1px 2px 0px, rgba(60, 64, 67, 0.15) 0px 1px 3px 1px"}))),It=fe("ticket/getTicketList",(async(e,{rejectWithValue:t})=>{try{return(await Je.get("/api/v1/ticket/list")).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Et=fe("ticket/getTicketById",(async(e,{rejectWithValue:t})=>{try{return(await Je.get(`/api/v1/ticket/${e}`)).data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Rt=fe("ticket/updateTicket",(async({ticket_id:e,ticketData:t},{rejectWithValue:a})=>{try{return(await Je.patch(`/api/v1/ticket/update/${e}`,t)).data}catch(i){if(!i.response)throw i;return a(i.response.data)}})),Tt=fe("ticket/createTicket",(async(e,{rejectWithValue:t})=>{try{return(await Je.post("/api/v1/ticket/create",e)).data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),qt=fe("ticket/deleteTicket",(async(e,{rejectWithValue:t})=>{try{return(await Je.delete(`/api/v1/ticket/delete/${e}`)).data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Wt=({atr:e,open:i,setOpen:r,ticketId:n,setTicketId:l,institutionId:o,setInstitutionId:d})=>{const c=Re(),u=F(c.breakpoints.down("md")),m=s(),p=()=>{r(!1)};return t.jsx(a.Fragment,{children:t.jsxs(Y,{fullScreen:u,open:i,onClose:p,"aria-labelledby":"responsive-dialog-title",children:[t.jsx(M,{children:t.jsx(U,{children:t.jsxs(k,{className:"text-black font-semibold",children:["Are you sure you want to delete this ",e,"?"]})})}),t.jsxs(H,{children:[t.jsx(E,{autoFocus:!0,onClick:p,children:"Cancel"}),t.jsx(E,{onClick:async()=>{switch(e){case"ticket":await m(qt(n)),await m(It()),r(!1),l(null);break;case"organization":await m(vt(o)),await m(xt()),r(!1),d(null)}},autoFocus:!0,children:"Confirm"})]})]})})};Wt.propTypes={atr:x.string.isRequired,open:x.bool.isRequired,setOpen:x.func.isRequired,ticketId:x.number,setTicketId:x.func,institutionId:x.number,setInstitutionId:x.func};const Dt=j($)({padding:0,"&:hover":{backgroundColor:"transparent"}}),At=j(z)({display:"flex",flexDirection:"row"}),Lt=({submenu:e})=>t.jsx(At,{children:null==e?void 0:e.map(((e,a)=>t.jsx(Dt,{disableRipple:!0,onClick:(null==e?void 0:e.link)?null==e?void 0:e.link:(null==e?void 0:e.onClick)||null,children:t.jsx(O,{children:e.icon})},`table-item-${a}`)))});Lt.propTypes={submenu:x.arrayOf(x.shape({icon:x.node,link:x.func,onClick:x.func}))};const $t=Te(B)((({theme:e})=>({[`&.${G.head}`]:{backgroundColor:e.palette.common.black,color:e.palette.common.white},[`&.${G.body}`]:{fontSize:14}}))),Vt=({headCells:e})=>t.jsx(J,{children:t.jsx(K,{children:e.map((e=>t.jsx($t,{align:e.align||"left",style:{minWidth:e.minWidth},children:e.label},e.id)))})});Vt.propTypes={headCells:x.arrayOf(x.shape({id:x.string.isRequired,align:x.string,minWidth:x.number,label:x.string.isRequired})).isRequired};const Ft=Te(B)((({theme:e})=>({[`&.${G.head}`]:{backgroundColor:e.palette.common.black,color:e.palette.common.white},[`&.${G.body}`]:{fontSize:14}}))),Yt=Te(K)((({theme:e})=>({"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}))),Mt=({rows:e,page:a,rowsPerPage:i,headCells:s})=>t.jsx(Z,{children:e.slice(a*i,a*i+i).map(((e,a)=>t.jsx(Yt,{hover:!0,role:"checkbox",tabIndex:-1,children:s.map((a=>{const i=e[a.id];return t.jsx(Ft,{align:a.align,children:a.format&&"number"==typeof i?a.format(i):i},a.id)}))},a)))});Mt.propTypes={rows:x.array.isRequired,page:x.number.isRequired,rowsPerPage:x.number.isRequired,headCells:x.array.isRequired};const Ut=({headCells:e,rows:a,page:i,rowsPerPage:s,handleChangePage:r,handleChangeRowsPerPage:n})=>t.jsxs(Q,{sx:{width:"100%",overflow:"hidden"},children:[t.jsx(X,{component:Q,children:t.jsxs(ee,{sx:{minWidth:700,border:"1px solid #e0e0e0"},stickyHeader:!0,"aria-label":"sticky table",children:[t.jsx(Vt,{headCells:e}),t.jsx(Mt,{rows:a,page:i,rowsPerPage:s,headCells:e})]})}),t.jsx(te,{rowsPerPageOptions:[10,25,100],component:"div",count:a.length,rowsPerPage:s,page:i,onPageChange:r,onRowsPerPageChange:n})]});Ut.propTypes={headCells:x.array.isRequired,rows:x.array.isRequired,page:x.number.isRequired,rowsPerPage:x.number.isRequired,handleChangePage:x.func.isRequired,handleChangeRowsPerPage:x.func.isRequired};const Ht=[{id:"name",label:"Name",minWidth:130},{id:"email",label:"Email",minWidth:140},{id:"phone",label:"Phone",minWidth:100},{id:"address",label:"Address",minWidth:150},{id:"status",label:"Status",minWidth:150},{id:"action",label:"",minWidth:10}],zt=()=>{const i=c(),n=s(),l=r(yt),[o,d]=e.useState(0),[u,m]=e.useState(10),[p,h]=e.useState([]),[x,f]=a.useState(!1),[j,g]=a.useState(null),v=_e({defaultValues:{name:""}});e.useEffect((()=>{n(xt())}),[n]);const{handleSubmit:b,control:_,getValues:y,reset:w}=v,P=e=>{let a=[];l&&Array.isArray(l)&&(a=((e,t)=>{const a=null==t?void 0:t.toLowerCase();return e&&Array.isArray(e)?e.filter((e=>!a||(null==e?void 0:e.name.toLowerCase().includes(a)))):[]})(l||[],null==e?void 0:e.name));const s=a.map((e=>{const a=null==e?void 0:e.institution_id,s=[];return s.push({icon:t.jsx(se,{fontSize:"small",sx:{color:"black"}}),link:a?()=>{i(`${ze.institutionsPath}/${a}`)}:null},{icon:t.jsx(re,{fontSize:"small",sx:{color:"black"}}),link:a?()=>{i(`${ze.institutionsPath}/${a}/edit`)}:null},{icon:t.jsx(ne,{fontSize:"small",sx:{color:"black"}}),onClick:()=>{f(!0),g(a)}}),{name:null==e?void 0:e.name,email:null==e?void 0:e.email,phone:null==e?void 0:e.phone,address:null==e?void 0:e.address,status:0===(null==e?void 0:e.status)?$e[0].value:$e[1].value,action:t.jsx(Lt,{submenu:s})}}));h(s)};return e.useEffect((()=>{l&&P(y())}),[l]),t.jsxs(t.Fragment,{children:[t.jsxs(ot,{children:[t.jsx(k,{variant:"h5",children:"Institutions Page"}),t.jsx(ye,{...v,children:t.jsx("form",{onSubmit:b(P),children:t.jsxs("div",{className:"flex flex-row pt-5",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ke,{name:"name",control:_,render:({field:{onChange:e,value:a},fieldState:{error:i}})=>t.jsx("div",{children:t.jsx(C,{name:"name",type:"text",id:"outlined-basic input-with-icon-textfield",value:a,placeholder:"Enter institution name",onChange:e,error:!!i,autoComplete:"off",fullWidth:!0,slotProps:{input:{startAdornment:t.jsx(N,{position:"start",children:t.jsx(ae,{})}),endAdornment:t.jsx(N,{position:"end",children:t.jsx(ie,{onClick:()=>w(),className:"cursor-pointer"})}),sx:{height:35}}},variant:"outlined"})})})}),t.jsx("div",{className:"px-3",children:t.jsx(St,{type:"submit",variant:"outlined",children:"Search"})}),t.jsx(St,{variant:"outlined",onClick:()=>i(ze.addInstitutionPath),children:"Create Institution"})]})})}),t.jsx("br",{}),t.jsx(Ut,{headCells:Ht,rows:p,page:o,rowsPerPage:u,handleChangePage:(e,t)=>{d(t)},handleChangeRowsPerPage:e=>{m(+e.target.value),d(0)}})]}),t.jsx(Wt,{atr:"organization",open:x,setOpen:f,institutionId:j,setInstitutionId:g})]})},Ot=fe("locker/getLockerListByInstitution",(async({institution_id:e},{rejectWithValue:t})=>{try{return(await Je.get(`/api/v1/locker/list/${e}`)).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Bt=fe("locker/getLockerById",(async({locker_id:e},{rejectWithValue:t})=>{try{return(await Je.get(`/api/v1/locker/${e}`)).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Gt=fe("locker/updateLocker",(async({locker_id:e,lockerData:t},{rejectWithValue:a})=>{try{return(await Je.patch(`/api/v1/locker/update/${e}`,t)).data}catch(i){if(!i.response)throw i;return a(i.response.data)}})),Jt=fe("locker/createLocker",(async({lockerData:e},{rejectWithValue:t})=>{try{return(await Je.post("/api/v1/locker/create",e)).data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Kt=fe("locker/deleteLocker",(async({locker_id:e},{rejectWithValue:t})=>{try{return(await Je.delete(`/api/v1/locker/delete/${e}`)).data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Zt=je({name:"locker",initialState:{lockers:[],loading:Ye,error:null,locker:{id:"",institution_id:"",locker_number:"",status:""}},reducers:{},extraReducers:e=>{e.addCase(Ot.pending,(e=>{e.loading=Me})).addCase(Ot.fulfilled,((e,t)=>{e.loading=Ue,e.lockers=t.payload.map((e=>({id:e.id,institution_id:e.institution_id,locker_number:e.locker_number,status:e.status}))),e.error=null})).addCase(Ot.rejected,((e,t)=>{e.loading=He,e.lockers=[],e.error=t.error.message})).addCase(Bt.pending,(e=>{e.loading=Me})).addCase(Bt.fulfilled,((e,t)=>{e.loading=Ue,e.locker={...e.locker,...t.payload},e.error=null})).addCase(Bt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(Gt.pending,(e=>{e.loading=Me})).addCase(Gt.fulfilled,((e,t)=>{e.loading=Ue,e.lockers=e.lockers.map((e=>e.id===t.payload.id?t.payload:e)),e.error=null})).addCase(Gt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(Jt.pending,(e=>{e.loading=Me})).addCase(Jt.fulfilled,((e,t)=>{e.loading=Ue,e.lockers.push(t.payload),e.error=null})).addCase(Jt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(Kt.pending,(e=>{e.loading=Me})).addCase(Kt.fulfilled,((e,t)=>{e.loading=Ue,e.lockers=e.lockers.filter((e=>e.id!==t.payload.id)),e.error=null})).addCase(Kt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message}))}}).reducer,Qt=e=>e.locker.lockers,Xt=e=>e.locker.locker,ea=[{id:"locker_number",label:"Locker number",minWidth:200},{id:"institution",label:"Institution",minWidth:200},{id:"status",label:"Locker status",minWidth:150},{id:"action",label:"",minWidth:10}],ta=()=>{const a=s(),i=c(),{id:n}=m(),l=r(Qt),[o,d]=e.useState(0),[u,p]=e.useState(10),[h,x]=e.useState([]),f=r(wt),j=_e({defaultValues:{locker_number:"",institution:""}});e.useEffect((()=>{a(Ot({institution_id:n}))}),[a,n]),e.useEffect((()=>{l&&n&&a(ft(n))}),[a,n,l]);const{handleSubmit:g,control:v,getValues:b,reset:_}=j,y=e=>{let a=[];l&&Array.isArray(l)&&(a=((e,t)=>{const a=t?t.toString().toLowerCase():null;return e&&Array.isArray(e)?e.filter((e=>!a||(null==e?void 0:e.locker_number.toString().toLowerCase().includes(a)))):[]})(l||[],null==e?void 0:e.locker_number,null==e||e.institution));const s=a.map((e=>{const a=null==e?void 0:e.id,s=[];return s.push({icon:t.jsx(se,{fontSize:"small",sx:{color:"black"}}),link:a?()=>{i(`${ze.lockersPath}/${a}`)}:null}),{locker_number:null==e?void 0:e.locker_number,institution:null==f?void 0:f.name,status:0==(null==e?void 0:e.status)?Ve[0].value:Ve[1].value,action:t.jsx(Lt,{submenu:s})}}));x(s)};return e.useEffect((()=>{l&&y(b())}),[l]),t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Lockers of Institution"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>i(-1),children:"Go back"})]}),t.jsx(ye,{...j,children:t.jsx("form",{onSubmit:g(y),children:t.jsxs("div",{className:"flex flex-row pt-5 space-x-3",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ke,{name:"locker_number",control:v,render:({field:{onChange:e,value:a},fieldState:{error:i}})=>t.jsx(C,{name:"locker_number",type:"text",className:"col-span-2",value:a,placeholder:"Enter locker number",onChange:e,error:!!i,autoComplete:"off",fullWidth:!0,slotProps:{input:{startAdornment:t.jsx(N,{position:"start",children:t.jsx(ae,{})}),endAdornment:t.jsx(N,{position:"end",children:t.jsx(ie,{onClick:()=>_(),className:"cursor-pointer"})}),sx:{height:35}}},variant:"outlined"})})}),t.jsx(St,{type:"submit",variant:"outlined",children:"Search"})]})})}),t.jsx("br",{}),t.jsx(Ut,{headCells:ea,rows:h,page:o,rowsPerPage:u,handleChangePage:(e,t)=>{d(t)},handleChangeRowsPerPage:e=>{p(+e.target.value),d(0)}})]})},aa=({handleSubmit:a,onSubmit:i,control:n,formErrors:l})=>{const o=s(),{institution_id:d}=f(sessionStorage.getItem("token")),c=r(wt);return e.useEffect((()=>{o(ft(d))}),[o,d]),t.jsxs("form",{onSubmit:a(i),className:"grid gap-4 py-3",children:[t.jsx(ke,{name:"locker_number",control:n,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==l?void 0:l.ticketName),helperText:null==(i=null==l?void 0:l.ticketName)?void 0:i.message,label:"Locker Number",variant:"outlined"})}}),t.jsx(ke,{name:"institution_id",control:n,render:({field:{onChange:e}})=>{var a;return t.jsx(C,{value:c.name,onChange:e,error:!!(null==l?void 0:l.institution_id),helperText:null==(a=null==l?void 0:l.institution_id)?void 0:a.message,required:!0,label:"Institution",variant:"outlined",disabled:!0})}}),t.jsx(ke,{name:"status",control:n,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{select:!0,value:a,onChange:e,error:!!(null==l?void 0:l.status),helperText:null==(i=null==l?void 0:l.status)?void 0:i.message,label:"Locker status",variant:"outlined",children:Ve.map((e=>t.jsx($,{value:e.id,children:e.value},e.id)))})}}),t.jsx(E,{type:"submit",variant:"contained",children:"Save ticket"})]})};aa.propTypes={handleSubmit:x.func.isRequired,onSubmit:x.func.isRequired,control:x.object.isRequired,formErrors:x.object};const ia=we().shape({locker_number:Ne().required("Locker number is required"),status:Ne().required("Locker status is required")}),sa=()=>{const e=c(),a=s(),{institution_id:i}=f(sessionStorage.getItem("token")),{handleSubmit:r,control:n,formState:{errors:l},reset:o}=_e({resolver:be(ia),defaultValues:{locker_number:"",institution_id:null,status:""}});return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Add Locker"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>e(ze.lockersPath),children:"Go back Lockers page"})]}),t.jsx(aa,{handleSubmit:r,onSubmit:e=>{const t={...e,institution_id:parseInt(i,10)};a(Jt({lockerData:t})).catch((e=>{console.log(e)})),o()},control:n,formErrors:l})]})},ra=()=>{const{id:a}=m(),i=c(),n=s(),l=r(Xt),{institution_id:o}=f(sessionStorage.getItem("token"));e.useEffect((()=>{n(Bt({locker_id:a}))}),[n,a]);const{handleSubmit:d,control:u,formState:{errors:p},reset:h}=_e({resolver:be(ia),defaultValues:{locker_number:"",institution_id:"",status:""}});e.useEffect((()=>{l&&h({locker_number:l.locker_number||"",institution_id:o||"",status:0==l.status?Ve[0].id:Ve[1].id||""})}),[l,h,o]);return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Edit locker"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>i(ze.lockersPath),children:"Go back Lockers page"})]}),t.jsx(aa,{handleSubmit:d,onSubmit:e=>{const t={...e,institution_id:o};n(Gt({locker_id:a,lockerData:t})).then((()=>{n(Bt({locker_id:a}))})).catch((e=>{console.error(e)}))},control:u,formErrors:p})]})},na=()=>{const a=c(),i=s(),{id:n}=m(),l=r(Xt),o=r(wt);return e.useEffect((()=>{i(Bt({locker_id:n}))}),[i,n]),e.useEffect((()=>{l&&l.institution_id&&i(ft(l.institution_id))}),[i,l]),t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Locker details"}),t.jsx(st,{allowedRoles:[Le[1].value],children:t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(-1),children:"Go back"})}),t.jsxs(st,{allowedRoles:[Le[2].value],children:[t.jsxs("div",{className:"flex flex-row",children:[t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(ze.lockersPath),children:"Go back Lockers page"}),t.jsx("p",{className:"px-3",children:" | "}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(`${ze.lockersPath}/${n}/edit`),children:"Edit"})]})," "]})]}),t.jsxs("div",{className:"grid gap-4 py-3",children:[t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Locker number:"}),t.jsx("p",{className:"px-2",children:l.locker_number})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Institution:"}),t.jsx("p",{className:"px-2",children:o.name})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Status:"}),t.jsx("p",{className:"px-2",children:0==l.status?Ve[0].value:Ve[1].value})]})]})]})},la=[{id:"locker_number",label:"Locker number",minWidth:200},{id:"institution",label:"Institution",minWidth:200},{id:"status",label:"Locker status",minWidth:150},{id:"action",label:"",minWidth:10}],oa=()=>{const a=c(),i=s(),n=r(Qt),[l,o]=e.useState(0),[d,u]=e.useState(10),[m,p]=e.useState([]),{institution_id:h}=f(sessionStorage.getItem("token")),x=r(wt),j=_e({defaultValues:{locker_number:"",institution:""}});e.useEffect((()=>{i(Ot({institution_id:h}))}),[i,h]),e.useEffect((()=>{n&&h&&i(ft(h))}),[i,h,n]);const{handleSubmit:g,control:v,getValues:b,reset:_}=j,y=e=>{let i=[];n&&Array.isArray(n)&&(i=((e,t)=>{const a=t?t.toString().toLowerCase():null;return e&&Array.isArray(e)?e.filter((e=>!a||(null==e?void 0:e.locker_number.toString().toLowerCase().includes(a)))):[]})(n||[],null==e?void 0:e.locker_number,null==e||e.institution));const s=i.map((e=>{const i=null==e?void 0:e.id,s=[];return s.push({icon:t.jsx(se,{fontSize:"small",sx:{color:"black"}}),link:i?()=>{a(`${ze.lockersPath}/${i}`)}:null},{icon:t.jsx(re,{fontSize:"small",sx:{color:"black"}}),link:i?()=>{a(`${ze.lockersPath}/${i}/edit`)}:null},{icon:t.jsx(ne,{fontSize:"small",sx:{color:"black"}}),onClick:()=>{console.log("Delete ticket")}}),{locker_number:null==e?void 0:e.locker_number,institution:null==x?void 0:x.name,status:0==(null==e?void 0:e.status)?Ve[0].value:Ve[1].value,action:t.jsx(Lt,{submenu:s})}}));p(s)};return e.useEffect((()=>{n&&y(b())}),[n]),t.jsx(t.Fragment,{children:t.jsxs(ot,{children:[t.jsx(k,{variant:"h5",children:"Lockers Page"}),t.jsx(ye,{...j,children:t.jsx("form",{onSubmit:g(y),children:t.jsxs("div",{className:"flex flex-row pt-5 space-x-3",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ke,{name:"locker_number",control:v,render:({field:{onChange:e,value:a},fieldState:{error:i}})=>t.jsx(C,{name:"locker_number",type:"text",className:"col-span-2",value:a,placeholder:"Enter locker number",onChange:e,error:!!i,autoComplete:"off",fullWidth:!0,slotProps:{input:{startAdornment:t.jsx(N,{position:"start",children:t.jsx(ae,{})}),endAdornment:t.jsx(N,{position:"end",children:t.jsx(ie,{onClick:()=>_(),className:"cursor-pointer"})}),sx:{height:35}}},variant:"outlined"})})}),t.jsx(St,{type:"submit",variant:"outlined",children:"Search"}),t.jsx(St,{variant:"outlined",onClick:()=>a(ze.addLockerPath),children:"Create locker"})]})})}),t.jsx("br",{}),t.jsx(Ut,{headCells:la,rows:m,page:l,rowsPerPage:d,handleChangePage:(e,t)=>{o(t)},handleChangeRowsPerPage:e=>{u(+e.target.value),o(0)}})]})})},da=()=>t.jsx("section",{className:"bg-white dark:bg-gray-900",children:t.jsx("div",{className:"py-8 px-4 mx-auto max-w-screen-xl lg:py-16 lg:px-6",children:t.jsxs("div",{className:"mx-auto max-w-screen-sm text-center",children:[t.jsx("h1",{className:"mb-4 text-7xl tracking-tight font-extrabold lg:text-9xl text-primary-600 dark:text-primary-500",children:"404"}),t.jsx("p",{className:"mb-4 text-3xl tracking-tight font-bold text-gray-900 md:text-4xl dark:text-white",children:"Something is missing."}),t.jsxs("p",{className:"mb-4 text-lg font-light text-gray-500 dark:text-gray-400",children:["Sorry, we can not find that page. You will find lots to explore on the home page."," "]}),t.jsx("a",{href:"/",className:"inline-flex text-gray-900 bg-primary-600 hover:bg-primary-800 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:focus:ring-primary-900 my-4",children:"Back to Homepage"})]})})}),ca=[{institution_id:1,name:"Club 1",email:"club1@gmail.com",phone:"+1-800-123-4567",address:"123 Tech Lane, Silicon Valley, CA 94043",map_location:"https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d3560.7065152972377!2d22.26369!3d60.455873!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x468c76f7886cb083%3A0x6d7bccbdea590557!2sL%C3%A4ntinen%20Pitk%C3%A4katu%208%2C%2020100%20Turku!5e1!3m2!1sen!2sfi!4v1730636906519!5m2!1sen!2sfi",details:"Club 1 is a tech club that offers a variety of tech-related activities and events. We have a team of experts who are passionate about technology and are dedicated to helping you learn and grow. Join us today and take your tech skills to the next level!",cover_photo:[],video_link:[],status:$e[0].value},{institution_id:2,name:"Club 2",email:"club2@gmail.com",phone:"+1-800-765-4321",address:"456 Wellness Blvd, New York, NY 10001",map_location:"https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d3560.7065152972377!2d22.26369!3d60.455873!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x468c76f7886cb083%3A0x6d7bccbdea590557!2sL%C3%A4ntinen%20Pitk%C3%A4katu%208%2C%2020100%20Turku!5e1!3m2!1sen!2sfi!4v1730636906519!5m2!1sen!2sfi",details:"Club 1 is a tech club that offers a variety of tech-related activities and events. We have a team of experts who are passionate about technology and are dedicated to helping you learn and grow. Join us today and take your tech skills to the next level!",cover_photo:[],video_link:[],status:$e[1].value},{institution_id:3,name:"Club 3",email:"club3@gmail.com",phone:"+1-800-987-6543",address:"789 Commerce St, Chicago, IL 60605",map_location:"https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d3560.7065152972377!2d22.26369!3d60.455873!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x468c76f7886cb083%3A0x6d7bccbdea590557!2sL%C3%A4ntinen%20Pitk%C3%A4katu%208%2C%2020100%20Turku!5e1!3m2!1sen!2sfi!4v1730636906519!5m2!1sen!2sfi",details:"Club 1 is a tech club that offers a variety of tech-related activities and events. We have a team of experts who are passionate about technology and are dedicated to helping you learn and grow. Join us today and take your tech skills to the next level!",cover_photo:[],video_link:[],status:$e[0].value}],ua=({handleSubmit:e,onSubmit:a,control:i,formErrors:s,setValue:r,watch:n})=>{const l=n("profile_pic"),o=Ae["image"].map((e=>`.${e}`)).toString();return t.jsxs("form",{onSubmit:e(a),className:"grid gap-4 py-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(ke,{name:"name",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.name),helperText:null==(i=null==s?void 0:s.name)?void 0:i.message,label:"User Name",variant:"outlined"})}}),t.jsx(ke,{name:"email",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.email),helperText:null==(i=null==s?void 0:s.email)?void 0:i.message,label:"Email",variant:"outlined"})}})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(ke,{name:"phone",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.phone),helperText:null==(i=null==s?void 0:s.phone)?void 0:i.message,label:"Phone",variant:"outlined"})}}),t.jsx(ke,{name:"date_of_birth",control:i,defaultValue:qe(),render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(le,{dateAdapter:oe,children:t.jsx(de,{label:"DOB",format:"DD/MM/YYYY",value:a||qe(),onChange:e,slotProps:{textField:{error:!!(null==s?void 0:s.date_of_birth),helperText:null==(i=null==s?void 0:s.date_of_birth)?void 0:i.message}}})})}})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(ke,{name:"role",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{select:!0,value:a,onChange:e,error:!!(null==s?void 0:s.role),helperText:null==(i=null==s?void 0:s.role)?void 0:i.message,label:"Role",variant:"outlined",children:Le.map((e=>t.jsx($,{value:e.id,children:e.value},e.id)))})}}),t.jsx(ke,{name:"institution_id",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{select:!0,value:a,onChange:e,error:!!(null==s?void 0:s.institution_id),helperText:null==(i=null==s?void 0:s.institution_id)?void 0:i.message,label:"Institution",variant:"outlined",children:ca.map((e=>t.jsx($,{value:e.institution_id,children:e.name},e.institution_id)))})}})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(ke,{name:"password",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.password),helperText:null==(i=null==s?void 0:s.password)?void 0:i.message,label:"Password",variant:"outlined"})}}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(k,{children:"Social ID:"}),t.jsx(ke,{name:"is_social",control:i,render:({field:{onChange:e,value:a}})=>t.jsx(ce,{checked:a,onChange:t=>e(t.target.checked)})}),n("is_social")&&t.jsx(ke,{name:"social_uuid",control:i,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==s?void 0:s.social_uuid),helperText:null==(i=null==s?void 0:s.social_uuid)?void 0:i.message,label:"Social UUID",variant:"outlined"})}})]})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"button label",htmlFor:"images",children:t.jsxs("span",{children:["Upload profile picture (Validate file: [",o,"])"]})}),t.jsx(ke,{name:"profile_pic",control:i,render:({field:e})=>t.jsx("input",{id:"images",type:"file",accept:o,multiple:!0,onChange:t=>{const a=Array.from(t.target.files);e.onChange(a),r("profile_pic",a)}})}),l&&l.length>0&&t.jsx(ct,{className:{margin:"auto"},width:300,height:"auto",files:l})]}),t.jsx(E,{type:"submit",variant:"contained",children:"Save user"})]})};ua.propTypes={handleSubmit:x.func.isRequired,onSubmit:x.func.isRequired,control:x.object.isRequired,formErrors:x.object,setValue:x.func.isRequired,watch:x.func.isRequired};const ma=we().shape({name:Ce().required("Name is required"),email:Ce().email().required("Email is required"),phone:Ce().required("Phone is required"),date_of_birth:Pe().required("Date of birth is required"),password:Ce().required("Password is required"),role:Ne().required("Role is required"),institution_id:Ne().required("Institution is required"),is_social:Se(),social_uuid:Ce().when("is_social",{is:!0,then:Ce().required("Social UUID is required")}),profile_pic:Ie().of(Ee().test("is-valid-type","Not a valid image type",(e=>{return t=e&&e.name.toLowerCase(),a="image",t&&Ae[a].indexOf(t.split(".").pop())>-1;var t,a})).test("is-valid-size","Max allowed size is 100KB",(e=>e&&e.size<=102400)))}),pa=fe("user/getUserList",(async(e,{rejectWithValue:t})=>{try{return(await Je.get("/api/v1/users/list")).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),ha=fe("user/getUserById",(async({user_id:e},{rejectWithValue:t})=>{try{return(await Je.get(`/api/v1/users/profile/info/${e}`)).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),xa=fe("user/createUser",(async({userData:e},{rejectWithValue:t})=>{try{return(await Je.post("/api/v1/users/create-user",e)).data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),fa=fe("user/getUserInformation",(async(e,{rejectWithValue:t})=>{try{return(await Je.get("/api/v1/users/profile/info")).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),ja=()=>{const e=c(),a=s(),{handleSubmit:i,control:r,formState:{errors:n},reset:l,setValue:o,watch:d}=_e({resolver:be(ma),defaultValues:{name:"",email:"",phone:"",date_of_birth:qe(),password:"",role:"",institution_id:null,is_social:!1,social_uuid:"",profile_pic:[]}});return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Add user"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>e(ze.usersPath),children:"Go back Users page"})]}),t.jsx(ua,{handleSubmit:i,onSubmit:e=>{const t=new FormData;t.append("name",e.name),t.append("email",e.email),t.append("phone",e.phone),t.append("date_of_birth",e.date_of_birth.toISOString()),t.append("password",e.password),t.append("role",parseInt(e.role,10)),t.append("institution_id",parseInt(e.institution_id,10)),t.append("is_social",e.is_social?1:0),t.append("social_uuid",e.social_uuid),e.images.forEach((e=>{t.append("images",e)})),a(xa(t)),l()},control:r,formErrors:n,setValue:o,watch:d})]})},ga=[{user_id:1,name:"John Doe",email:"JohnDoe@gmail.com",phone:"1234567890",date_of_birth:"01/01/2000",password:"password",role:Le[1].value,institution_id:1,is_social:!1,social_uuid:"",profile_pic:[]},{user_id:2,name:"Jane Doe",email:"JaneDoe@gmail.com",phone:"0987654321",date_of_birth:"02/02/2000",password:"password",role:Le[0].value,institution_id:"",is_social:!0,social_uuid:"1232434",profile_pic:[]}],va=()=>{const{id:a}=m(),i=c(),{handleSubmit:s,control:r,formState:{errors:n},reset:l,setValue:o,watch:d}=_e({resolver:be(ma),defaultValues:{name:"",email:"",phone:"",date_of_birth:qe(),password:"",role:"",institution:"",is_social:!1,social_uuid:"",profile_pic:[]}});e.useEffect((()=>{const e=ga.find((e=>e.user_id===Number(a)));if(e){const t=ca.find((t=>t.institution_id===Number(e.institution_id)));l({name:e.name,email:e.email,phone:e.phone,date_of_birth:qe(e.date_of_birth)||qe(),password:e.password,role:e.role,institution:t?t.name:"",is_social:e.is_social,social_uuid:e.social_uuid,profile_pic:e.profile_pic||[]})}}),[a,l]);return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Edit user"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>i(ze.usersPath),children:"Go back Users page"})]}),t.jsx(ua,{handleSubmit:s,onSubmit:e=>{console.log("Submit data:",e)},control:r,formErrors:n,setValue:o,watch:d})]})},ba=je({name:"user",initialState:{users:[],loading:Ye,error:null,user:{id:"",name:"",email:"",phone:"",role:"",is_social:!1,institution_id:"",date_of_birth:"",social_uuid:"",profile_pic:""},userLogin:{user_id:"",name:"",email:"",phone:"",role:"",is_social:!1,institution_id:"",date_of_birth:"",social_uuid:"",profile_pic:""}},reducers:{},extraReducers:e=>{e.addCase(pa.pending,(e=>{e.loading=Me})).addCase(pa.fulfilled,((e,t)=>{e.loading=Ue,e.users=t.payload,e.error=null})).addCase(pa.rejected,((e,t)=>{e.loading=He,e.tickets=[],e.error=t.error.message})).addCase(ha.pending,(e=>{e.loading=Me})).addCase(ha.fulfilled,((e,t)=>{e.loading=Ue,e.user=t.payload,e.error=null})).addCase(ha.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(xa.pending,(e=>{e.loading=Me})).addCase(xa.fulfilled,((e,t)=>{e.loading=Ue,e.tickets.push(t.payload),e.error=null})).addCase(xa.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(fa.pending,(e=>{e.loading=Me})).addCase(fa.fulfilled,((e,t)=>{e.loading=Ue,e.userLogin=t.payload,e.error=null})).addCase(fa.rejected,((e,t)=>{e.loading=He,e.error=t.error.message}))}}).reducer,ka=e=>e.user.users,_a=e=>e.user.user,ya=()=>{const a=c(),{id:i}=m(),n=s(),l=r(_a),o=r(wt),[d,u]=e.useState("");return e.useEffect((()=>{n(ha({user_id:i}))}),[n,i]),e.useEffect((()=>{l.institution_id&&n(ft({institution_id:l.institution_id}))}),[n,l.institution_id]),e.useEffect((()=>{const e=Le.find((e=>e.id===l.role));u(null==e?void 0:e.value)}),[l.role]),t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"User details"}),t.jsx("div",{className:"flex flex-row",children:t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(ze.usersPath),children:"Go back Users page"})})]}),t.jsxs("div",{className:"grid gap-4 py-3",children:[t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"User name:"}),t.jsx("p",{className:"px-2",children:l.name})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Email:"}),t.jsx("p",{className:"px-2",children:l.email})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Phone:"}),t.jsx("p",{className:"px-2",children:l.phone})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"DOB:"}),t.jsx("p",{className:"px-2",children:qe(l.date_of_birth).format("DD/MM/YYYY")})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Role:"}),t.jsx("p",{className:"px-2",children:d})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Institution:"}),t.jsx("p",{className:"px-2",children:o.name})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("p",{className:"font-bold",children:"Social ID:"}),l.is_social?t.jsx("p",{className:"px-2",children:l.social_uuid}):t.jsx("p",{className:"px-2",children:"No Social ID"})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Profile picture:"}),t.jsx("div",{className:"px-2",children:l.profile_pic&&l.profile_pic.length>0&&t.jsx(ct,{className:{margin:"auto"},width:300,height:"auto",files:l.profile_pic})})]})]})]})},wa=[{id:"name",label:"User name",minWidth:250},{id:"email",label:"Email",minWidth:140},{id:"phone",label:"Phone",minWidth:100},{id:"date_of_birth",label:"DOB",minWidth:100},{id:"role",label:"Role",minWidth:150},{id:"institution",label:"Institution",minWidth:150},{id:"action",label:"",minWidth:10}],Ca=()=>{const a=c(),i=s(),n=r(yt),l=r(ka),[o,d]=e.useState(0),[u,m]=e.useState(10),[p,h]=e.useState([]);e.useEffect((()=>{i(pa())}),[i]),e.useEffect((()=>{l&&i(xt())}),[i,l]);const x=_e({defaultValues:{name:""}}),{handleSubmit:f,control:j,getValues:g,reset:v}=x,b=e=>{let i=[];l&&Array.isArray(l)&&(i=((e,t)=>{const a=null==t?void 0:t.toLowerCase();return e&&Array.isArray(e)?e.filter((e=>!a||(null==e?void 0:e.name.toLowerCase().includes(a)))):[]})(l||[],null==e?void 0:e.name));const s=i.map((e=>{var i;const s=null==e?void 0:e.user_id,r=[],l=n.find((t=>t.institution_id===Number(null==e?void 0:e.institution_id)));return r.push({icon:t.jsx(se,{fontSize:"small",sx:{color:"black"}}),link:s?()=>{a(`${ze.usersPath}/${s}`)}:null},{icon:t.jsx(re,{fontSize:"small",sx:{color:"black"}}),link:s?()=>{a(`${ze.usersPath}/${s}/edit`)}:null},{icon:t.jsx(ne,{fontSize:"small",sx:{color:"black"}}),onClick:()=>{console.log("Delete ticket")}}),{name:null==e?void 0:e.name,email:null==e?void 0:e.email,phone:null==e?void 0:e.phone,date_of_birth:(null==e?void 0:e.date_of_birth)?qe(null==e?void 0:e.date_of_birth).format("DD/MM/YYYY"):null,role:null==(i=Le.find((t=>t.id===(null==e?void 0:e.role))))?void 0:i.value,institution:null==l?void 0:l.name,action:t.jsx(Lt,{submenu:r})}}));h(s)};return e.useEffect((()=>{l&&b(g())}),[l]),t.jsx(t.Fragment,{children:t.jsxs(ot,{children:[t.jsx(k,{variant:"h5",children:"Users Page"}),t.jsx(ye,{...x,children:t.jsx("form",{onSubmit:f(b),children:t.jsxs("div",{className:"flex flex-row pt-5",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ke,{name:"name",control:j,render:({field:{onChange:e,value:a},fieldState:{error:i}})=>t.jsx("div",{children:t.jsx(C,{name:"name",type:"text",id:"outlined-basic input-with-icon-textfield",value:a,placeholder:"Enter user name",onChange:e,error:!!i,autoComplete:"off",fullWidth:!0,slotProps:{input:{startAdornment:t.jsx(N,{position:"start",children:t.jsx(ae,{})}),endAdornment:t.jsx(N,{position:"end",children:t.jsx(ie,{onClick:()=>v(),className:"cursor-pointer"})}),sx:{height:35}}},variant:"outlined"})})})}),t.jsx("div",{className:"px-3",children:t.jsx(St,{type:"submit",variant:"outlined",children:"Search"})}),t.jsx(St,{variant:"outlined",onClick:()=>a(ze.addUsersPath),children:"Create users"})]})})}),t.jsx("br",{}),t.jsx(Ut,{headCells:wa,rows:p,page:o,rowsPerPage:u,handleChangePage:(e,t)=>{d(t)},handleChangeRowsPerPage:e=>{m(+e.target.value),d(0)}})]})})},Na=je({name:"ticket",initialState:{tickets:[],loading:Ye,error:null,ticket:{id:"",name:"",description:"",institution_id:"",price:"",capacity:"",benefits:"",is_regular:"",date:"",start_datetime:"",end_datetime:""}},reducers:{},extraReducers:e=>{e.addCase(It.pending,(e=>{e.loading=Me})).addCase(It.fulfilled,((e,t)=>{e.loading=Ue,e.tickets=t.payload.map((e=>({id:e.ticket_id,name:e.name,description:e.description,institution_id:e.institution_id,price:e.price,capacity:e.capacity,benefits:e.benefits,is_regular:e.is_regular,date:e.date,start_datetime:e.start_datetime,end_datetime:e.end_datetime}))),e.error=null})).addCase(It.rejected,((e,t)=>{e.loading=He,e.tickets=[],e.error=t.error.message})).addCase(Et.pending,(e=>{e.loading=Me})).addCase(Et.fulfilled,((e,t)=>{e.loading=Ue,e.ticket={...e.ticket,...t.payload},e.error=null})).addCase(Et.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(Rt.pending,(e=>{e.loading=Me})).addCase(Rt.fulfilled,((e,t)=>{e.loading=Ue,e.tickets=e.tickets.map((e=>e.id===t.payload.ticket_id?t.payload:e)),e.error=null})).addCase(Rt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(Tt.pending,(e=>{e.loading=Me})).addCase(Tt.fulfilled,((e,t)=>{e.loading=Ue,e.tickets.push(t.payload),e.error=null})).addCase(Tt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message})).addCase(qt.pending,(e=>{e.loading=Me})).addCase(qt.fulfilled,((e,t)=>{e.loading=Ue,e.tickets=e.tickets.filter((e=>e.id!==t.payload.ticket_id)),e.error=null})).addCase(qt.rejected,((e,t)=>{e.loading=He,e.error=t.error.message}))}}).reducer,Pa=e=>e.ticket.tickets,Sa=e=>e.ticket.ticket,Ia=()=>{const a=c(),i=s(),{id:n}=m(),l=r(Sa),o=r(wt);return e.useEffect((()=>{i(Et(n))}),[i,n]),e.useEffect((()=>{l&&l.institution_id&&i(ft(l.institution_id))}),[i,l]),t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Ticket details"}),t.jsxs("div",{className:"flex flex-row",children:[t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(ze.ticketsPath),children:"Go back Tickets page"}),t.jsx("p",{className:"px-3",children:" | "}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(`${ze.ticketsPath}/${n}/edit`),children:"Edit"})]})]}),t.jsxs("div",{className:"grid gap-4 py-3",children:[t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket name:"}),t.jsx("p",{className:"px-2",children:l.name})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket description:"}),t.jsx("p",{className:"px-2",children:l.description})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Institution:"}),t.jsx("p",{className:"px-2",children:o.name})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket price:"}),t.jsx("p",{className:"px-2",children:l.price})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Capacity:"}),t.jsx("p",{className:"px-2",children:l.capacity})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Benefits:"}),t.jsx("p",{className:"px-2",children:l.benefits})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("p",{className:"font-bold",children:"Regular ticket:"}),t.jsx(ce,{checked:1===l.is_regular,disabled:!0,className:""})]}),!l.is_regular&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Date:"}),t.jsx("p",{className:"px-2",children:qe(l.date).format("DD-MM-YYYY")})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Start time:"}),t.jsx("p",{className:"px-2",children:l.start_datetime})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"End time:"}),t.jsx("p",{className:"px-2",children:l.end_datetime})]})]})]})]})},Ea=we().shape({name:Ce().required("Name is required"),description:Ce(),institution_id:Ne().typeError("Institution must be a number").required("Institution is required"),price:Ne().typeError("Price must be a number").min(0,"Price cannot be negative").required("Price is required"),capacity:Ne().typeError("Capacity must be a number").min(1,"Capacity must be at least 1").required("Capacity is required"),benefits:Ce(),is_regular:Se(),date:Pe().test("isValid","Invalid date",(e=>qe(e).isValid())).min(qe().startOf("day").toDate(),"Date must be today or later").when("is_regular",{is:!1,then:e=>e.required("Date is required"),otherwise:e=>e.notRequired()}),start_datetime:Ce().when("is_regular",{is:!0,then:e=>e.required("Start time is required").typeError("Invalid start time"),otherwise:e=>e.notRequired()}),end_datetime:Ce().when("is_regular",{is:!0,then:e=>e.required("End time is required").typeError("Invalid end time"),otherwise:e=>e.notRequired()})}),Ra=({handleSubmit:a,onSubmit:i,control:n,formErrors:l,watch:o})=>{const d=s(),c=r(yt);return e.useEffect((()=>{d(xt())}),[d]),t.jsxs("form",{onSubmit:a(i),className:"grid gap-4 py-3",children:[t.jsx(ke,{name:"name",control:n,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==l?void 0:l.name),helperText:null==(i=null==l?void 0:l.name)?void 0:i.message,label:"Ticket Name",variant:"outlined"})}}),t.jsx(ke,{name:"description",control:n,render:({field:{onChange:e,value:a}})=>t.jsx(C,{value:a,onChange:e,label:"Description",variant:"outlined",multiline:!0,rows:3})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsx(ke,{name:"institution_id",control:n,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{select:!0,value:a||"",onChange:e,error:!!(null==l?void 0:l.institution_id),helperText:null==(i=null==l?void 0:l.institution_id)?void 0:i.message,label:"Institution",variant:"outlined",children:c.map((e=>t.jsx($,{value:e.institution_id,children:e.name},e.institution_id)))})}}),t.jsx(ke,{name:"price",control:n,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==l?void 0:l.price),helperText:null==(i=null==l?void 0:l.price)?void 0:i.message,label:"Price",variant:"outlined"})}}),t.jsx(ke,{name:"capacity",control:n,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(C,{value:a,onChange:e,error:!!(null==l?void 0:l.capacity),helperText:null==(i=null==l?void 0:l.capacity)?void 0:i.message,label:"Capacity",variant:"outlined"})}})]}),t.jsx(ke,{name:"benefits",control:n,render:({field:{onChange:e,value:a}})=>t.jsx(C,{value:a,onChange:e,label:"Benefits",variant:"outlined",multiline:!0,rows:3})}),t.jsx(ke,{name:"is_regular",control:n,render:({field:{onChange:e,value:a}})=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ce,{checked:a||!1,onChange:t=>e(t.target.checked)}),t.jsx(k,{children:"Regular ticket"})]})}),!o("is_regular")&&t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsx(ke,{name:"date",control:n,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(le,{dateAdapter:oe,children:t.jsx(de,{label:"Date",value:a||null,onChange:e,format:"DD/MM/YYYY",slotProps:{textField:{error:!!(null==l?void 0:l.date),helperText:null==(i=null==l?void 0:l.date)?void 0:i.message}}})})}}),t.jsx(ke,{name:"start_datetime",control:n,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(le,{dateAdapter:oe,children:t.jsx(ue,{label:"Start Time",value:a?qe(a,"HH:mm:ss"):null,onChange:t=>{e(t?t.format("HH:mm:ss"):null)},format:"HH:mm:ss",slotProps:{textField:{error:!!(null==l?void 0:l.start_datetime),helperText:null==(i=null==l?void 0:l.start_datetime)?void 0:i.message}}})})}}),t.jsx(ke,{name:"end_datetime",control:n,render:({field:{onChange:e,value:a}})=>{var i;return t.jsx(le,{dateAdapter:oe,children:t.jsx(ue,{label:"End Time",value:a?qe(a,"HH:mm:ss"):null,onChange:t=>{e(t?t.format("HH:mm:ss"):null)},format:"HH:mm:ss",slotProps:{textField:{error:!!(null==l?void 0:l.end_datetime),helperText:null==(i=null==l?void 0:l.end_datetime)?void 0:i.message}}})})}})]}),t.jsx(E,{type:"submit",variant:"contained",children:"Save ticket"})]})};Ra.propTypes={handleSubmit:x.func.isRequired,onSubmit:x.func.isRequired,control:x.object.isRequired,formErrors:x.object,watch:x.func.isRequired};const Ta=()=>{const{id:a}=m(),i=c(),n=s(),l=r(Sa);e.useEffect((()=>{n(Et(a))}),[n,a]);const{handleSubmit:o,control:d,formState:{errors:u},reset:p,watch:h}=_e({resolver:be(Ea),defaultValues:{name:"",description:"",institution_id:"",price:0,capacity:0,benefits:"",is_regular:!1,date:qe(),start_datetime:qe(),end_datetime:qe()}});e.useEffect((()=>{l&&p({name:l.name||"",description:l.description||"",institution_id:l.institution_id||null,price:l.price||0,capacity:l.capacity||0,benefits:l.benefits||"",is_regular:1===l.is_regular,date:l.is_regular?"":qe(l.date),start_datetime:l.is_regular?"":l.start_datetime,end_datetime:l.is_regular?"":l.end_datetime})}),[l]);return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Edit ticket"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>i(ze.ticketsPath),children:"Go back Tickets page"})]}),t.jsx(Ra,{handleSubmit:o,onSubmit:e=>{const t={...e,institution_id:parseInt(e.institution_id,10),price:parseFloat(e.price),capacity:parseInt(e.capacity,10),is_regular:e.is_regular?1:0,date:e.is_regular?"":e.date,start_datetime:e.is_regular?"":e.start_datetime,end_datetime:e.is_regular?"":e.end_datetime};n(Rt({ticket_id:a,ticketData:t})).then((()=>{n(Et(a))})).catch((e=>{console.error(e)}))},control:d,formErrors:u,watch:h})]})},qa=()=>{const e=c(),a=s(),{handleSubmit:i,control:r,formState:{errors:n},reset:l,watch:o}=_e({resolver:be(Ea),defaultValues:{name:"",description:"",institution_id:null,price:0,capacity:0,benefits:"",is_regular:!1,date:qe(),start_datetime:qe(),end_datetime:qe()}});return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Add ticket"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>e(ze.ticketsPath),children:"Go back Tickets page"})]}),t.jsx(Ra,{handleSubmit:i,onSubmit:e=>{const t={...e,institution_id:parseInt(e.institution_id,10),price:parseFloat(e.price),capacity:parseInt(e.capacity,10),is_regular:e.is_regular?1:0,date:e.is_regular?"":e.date,start_datetime:e.is_regular?"":e.start_datetime,end_datetime:e.is_regular?"":e.end_datetime};a(Tt(t)),l()},control:r,formErrors:n,watch:o})]})},Wa=[{id:"name",label:"Name",minWidth:250},{id:"institution",label:"Institution",minWidth:140},{id:"price",label:"Price",minWidth:100},{id:"capacity",label:"Capacity",minWidth:100},{id:"date",label:"Date",minWidth:120},{id:"start_datetime",label:"Time start",minWidth:120},{id:"end_datetime",label:"End time",minWidth:120},{id:"action",label:"",minWidth:10}],Da=()=>{const i=c(),n=s(),l=r(Pa),o=r(yt),[d,u]=e.useState(0),[m,p]=e.useState(10),[h,x]=e.useState([]),[f,j]=a.useState(!1),[g,v]=a.useState(null);e.useEffect((()=>{n(It())}),[n]),e.useEffect((()=>{(null==l?void 0:l.length)>0&&n(xt())}),[l]);const b=_e({defaultValues:{name:""}}),{handleSubmit:_,control:y,getValues:w,reset:P}=b,S=e=>{let a=[];l&&Array.isArray(l)&&(a=((e,t)=>{const a=null==t?void 0:t.toLowerCase();return e&&Array.isArray(e)?e.filter((e=>!a||(null==e?void 0:e.name.toLowerCase().includes(a)))):[]})(l||[],null==e?void 0:e.name));const s=a.map((e=>{const a=null==e?void 0:e.id,s=[],r=new Map(o.map((e=>[e.institution_id,e]))).get(Number(null==e?void 0:e.institution_id));return s.push({icon:t.jsx(se,{fontSize:"small",sx:{color:"black"}}),link:a?()=>{i(`${ze.ticketsPath}/${a}`)}:null},{icon:t.jsx(re,{fontSize:"small",sx:{color:"black"}}),link:a?()=>{i(`${ze.ticketsPath}/${a}/edit`)}:null},{icon:t.jsx(ne,{fontSize:"small",sx:{color:"black"}}),onClick:()=>{j(!0),v(a)}}),{name:null==e?void 0:e.name,institution:r.name,price:null==e?void 0:e.price,capacity:null==e?void 0:e.capacity,date:(null==e?void 0:e.is_regular)?"Regular event":qe(null==e?void 0:e.date).format("DD/MM/YYYY"),start_datetime:(null==e?void 0:e.is_regular)?"Regular event":null==e?void 0:e.start_datetime,end_datetime:(null==e?void 0:e.is_regular)?"Regular event":null==e?void 0:e.end_datetime,action:t.jsx(Lt,{submenu:s})}}));x(s)};return e.useEffect((()=>{l&&S(w())}),[l]),t.jsxs(t.Fragment,{children:[t.jsxs(ot,{children:[t.jsx(k,{variant:"h5",children:"Tickets Page"}),t.jsx(ye,{...b,children:t.jsx("form",{onSubmit:_(S),children:t.jsxs("div",{className:"flex flex-row pt-5",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ke,{name:"name",control:y,render:({field:{onChange:e,value:a},fieldState:{error:i}})=>t.jsx("div",{children:t.jsx(C,{name:"name",type:"text",id:"outlined-basic input-with-icon-textfield",value:a,placeholder:"Enter ticket name",onChange:e,error:!!i,autoComplete:"off",fullWidth:!0,slotProps:{input:{startAdornment:t.jsx(N,{position:"start",children:t.jsx(ae,{})}),endAdornment:t.jsx(N,{position:"end",children:t.jsx(ie,{onClick:()=>P(),className:"cursor-pointer"})}),sx:{height:35}}},variant:"outlined"})})})}),t.jsx("div",{className:"px-3",children:t.jsx(St,{type:"submit",variant:"outlined",children:"Search"})}),t.jsx(St,{variant:"outlined",onClick:()=>i(ze.addTicketPath),children:"Create ticket"})]})})}),t.jsx("br",{}),t.jsx(Ut,{headCells:Wa,rows:h,page:d,rowsPerPage:m,handleChangePage:(e,t)=>{u(t)},handleChangeRowsPerPage:e=>{p(+e.target.value),u(0)}})]}),t.jsx(Wt,{atr:"ticket",open:f,setOpen:j,ticketId:g,setTicketId:v})]})},Aa=[{id:"name",label:"Name",minWidth:250},{id:"institution",label:"Institution",minWidth:140},{id:"price",label:"Price",minWidth:100},{id:"capacity",label:"Capacity",minWidth:100},{id:"date",label:"Date",minWidth:120},{id:"start_datetime",label:"Time start",minWidth:120},{id:"end_datetime",label:"End time",minWidth:120},{id:"action",label:"",minWidth:10}],La=()=>{const i=c(),n=s(),{institution_id:l}=f(sessionStorage.getItem("token")),o=r(Ct),d=r(yt),[u,m]=e.useState(0),[p,h]=e.useState(10),[x,j]=e.useState([]),[g,v]=a.useState(!1),[b,_]=a.useState(null);e.useEffect((()=>{n(bt(l))}),[l]),e.useEffect((()=>{(null==o?void 0:o.length)>0&&n(xt())}),[o]);const y=_e({defaultValues:{name:""}}),{handleSubmit:w,control:P,getValues:S,reset:I}=y,E=e=>{let a=[];o&&Array.isArray(o)&&(a=((e,t)=>{const a=null==t?void 0:t.toLowerCase();return e&&Array.isArray(e)?e.filter((e=>!a||(null==e?void 0:e.name.toLowerCase().includes(a)))):[]})(o||[],null==e?void 0:e.name));const s=a.map((e=>{const a=null==e?void 0:e.ticket_id,s=[],r=new Map(d.map((e=>[e.institution_id,e]))).get(Number(null==e?void 0:e.institution_id));return s.push({icon:t.jsx(se,{fontSize:"small",sx:{color:"black"}}),link:a?()=>{i(`${ze.ticketsPathForInstitution}/${a}`)}:null},{icon:t.jsx(re,{fontSize:"small",sx:{color:"black"}}),link:a?()=>{i(`${ze.ticketPathForInstitution}/${a}/edit`)}:null},{icon:t.jsx(ne,{fontSize:"small",sx:{color:"black"}}),onClick:()=>{v(!0),_(a)}}),{name:null==e?void 0:e.name,institution:r.name,price:null==e?void 0:e.price,capacity:null==e?void 0:e.capacity,date:(null==e?void 0:e.is_regular)?"Regular event":qe(null==e?void 0:e.date).format("DD/MM/YYYY"),start_datetime:(null==e?void 0:e.is_regular)?"Regular event":null==e?void 0:e.start_datetime,end_datetime:(null==e?void 0:e.is_regular)?"Regular event":null==e?void 0:e.end_datetime,action:t.jsx(Lt,{submenu:s})}}));j(s)};return e.useEffect((()=>{o&&E(S())}),[o]),t.jsxs(t.Fragment,{children:[t.jsxs(ot,{children:[t.jsx(k,{variant:"h5",children:"Tickets Page"}),t.jsx(ye,{...y,children:t.jsx("form",{onSubmit:w(E),children:t.jsxs("div",{className:"flex flex-row pt-5",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ke,{name:"name",control:P,render:({field:{onChange:e,value:a},fieldState:{error:i}})=>t.jsx("div",{children:t.jsx(C,{name:"name",type:"text",id:"outlined-basic input-with-icon-textfield",value:a,placeholder:"Enter ticket name",onChange:e,error:!!i,autoComplete:"off",fullWidth:!0,slotProps:{input:{startAdornment:t.jsx(N,{position:"start",children:t.jsx(ae,{})}),endAdornment:t.jsx(N,{position:"end",children:t.jsx(ie,{onClick:()=>I(),className:"cursor-pointer"})}),sx:{height:35}}},variant:"outlined"})})})}),t.jsx("div",{className:"px-3",children:t.jsx(St,{type:"submit",variant:"outlined",children:"Search"})}),t.jsx(St,{variant:"outlined",onClick:()=>i(ze.addTicketPathForInstitution),children:"Create ticket"})]})})}),t.jsx("br",{}),t.jsx(Ut,{headCells:Aa,rows:x,page:u,rowsPerPage:p,handleChangePage:(e,t)=>{m(t)},handleChangeRowsPerPage:e=>{h(+e.target.value),m(0)}})]}),t.jsx(Wt,{atr:"ticket",open:g,setOpen:v,ticketId:b,setTicketId:_})]})},$a=()=>{const{id:a}=m(),i=c(),n=s(),l=r(Sa);e.useEffect((()=>{n(Et(a))}),[n,a]);const{handleSubmit:o,control:d,formState:{errors:u},reset:p,watch:h}=_e({resolver:be(Ea),defaultValues:{name:"",description:"",institution_id:"",price:0,capacity:0,benefits:"",is_regular:!1,date:qe(),start_datetime:qe(),end_datetime:qe()}});e.useEffect((()=>{l&&p({name:l.name||"",description:l.description||"",institution_id:l.institution_id||null,price:l.price||0,capacity:l.capacity||0,benefits:l.benefits||"",is_regular:1===l.is_regular,date:l.is_regular?"":qe(l.date),start_datetime:l.is_regular?"":l.start_datetime,end_datetime:l.is_regular?"":l.end_datetime})}),[l]);return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Edit ticket"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>i(ze.ticketPathForInstitution),children:"Go back Tickets page"})]}),t.jsx(Ra,{handleSubmit:o,onSubmit:e=>{const t={...e,institution_id:parseInt(e.institution_id,10),price:parseFloat(e.price),capacity:parseInt(e.capacity,10),is_regular:e.is_regular?1:0,date:e.is_regular?"":e.date,start_datetime:e.is_regular?"":e.start_datetime,end_datetime:e.is_regular?"":e.end_datetime};n(Rt({ticket_id:a,ticketData:t})).then((()=>{n(Et(a))})).catch((e=>{console.error(e)}))},control:d,formErrors:u,watch:h})]})},Va=()=>{const e=c(),a=s(),{handleSubmit:i,control:r,formState:{errors:n},reset:l,watch:o}=_e({resolver:be(Ea),defaultValues:{name:"",description:"",institution_id:null,price:0,capacity:0,benefits:"",is_regular:!1,date:qe(),start_datetime:qe(),end_datetime:qe()}});return t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Add ticket"}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>e(ze.ticketsPathForInstitution),children:"Go back Tickets page"})]}),t.jsx(Ra,{handleSubmit:i,onSubmit:e=>{const t={...e,institution_id:parseInt(e.institution_id,10),price:parseFloat(e.price),capacity:parseInt(e.capacity,10),is_regular:e.is_regular?1:0,date:e.is_regular?"":e.date,start_datetime:e.is_regular?"":e.start_datetime,end_datetime:e.is_regular?"":e.end_datetime};a(Tt(t)),l()},control:r,formErrors:n,watch:o})]})},Fa=()=>{const a=c(),i=s(),{id:n}=m(),l=r(Sa),o=r(wt);return e.useEffect((()=>{i(Et(n))}),[i,n]),e.useEffect((()=>{l&&l.institution_id&&i(ft(l.institution_id))}),[i,l]),t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Ticket details"}),t.jsxs("div",{className:"flex flex-row",children:[t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(ze.ticketsPathForInstitution),children:"Go back Tickets page"}),t.jsx("p",{className:"px-3",children:" | "}),t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>a(`${ze.ticketsPathForInstitution}/${n}/edit`),children:"Edit"})]})]}),t.jsxs("div",{className:"grid gap-4 py-3",children:[t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket name:"}),t.jsx("p",{className:"px-2",children:l.name})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket description:"}),t.jsx("p",{className:"px-2",children:l.description})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Institution:"}),t.jsx("p",{className:"px-2",children:o.name})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket price:"}),t.jsx("p",{className:"px-2",children:l.price})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Capacity:"}),t.jsx("p",{className:"px-2",children:l.capacity})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Benefits:"}),t.jsx("p",{className:"px-2",children:l.benefits})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("p",{className:"font-bold",children:"Regular ticket:"}),t.jsx(ce,{checked:1===l.is_regular,disabled:!0,className:""})]}),!l.is_regular&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Date:"}),t.jsx("p",{className:"px-2",children:qe(l.date).format("DD-MM-YYYY")})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Start time:"}),t.jsx("p",{className:"px-2",children:l.start_datetime})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"End time:"}),t.jsx("p",{className:"px-2",children:l.end_datetime})]})]})]})]})},Ya=fe("purchase/getPurchaseList",(async(e,{rejectWithValue:t})=>{try{return(await Je.get("/api/v1/purchase/list")).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Ma=fe("purchase/getPurchaseById",(async(e,{rejectWithValue:t})=>{try{return(await Je.get(`/api/v1/purchase/${e}`)).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Ua=fe("purchase/getPurchaseListForInstitution",(async(e,{rejectWithValue:t})=>{try{return(await Je.get(`/api/v1/purchase/list/institute/${e}`)).data.data}catch(a){if(!a.response)throw a;return t(a.response.data)}})),Ha=je({name:"purchase",initialState:{purchaseList:[],purchaseInfo:{purchase_id:"",user_id:"",ticket_id:"",purchase_date:"",ticket_date:"",price_amount:"",payment_status:"",payment_method:"",ticket_status:""},loading:Ye,error:null},reducers:{},extraReducers:e=>{e.addCase(Ya.pending,(e=>{e.loading=Me})).addCase(Ya.fulfilled,((e,t)=>{e.loading=Ue,e.purchaseList=t.payload,e.error=null})).addCase(Ya.rejected,((e,t)=>{e.loading=He,e.purchaseList=[],e.error=t.error.message})).addCase(Ua.pending,(e=>{e.loading=Me})).addCase(Ua.fulfilled,((e,t)=>{e.loading=Ue,e.purchaseList=t.payload,e.error=null})).addCase(Ua.rejected,((e,t)=>{e.loading=He,e.purchaseList=[],e.error=t.error.message})).addCase(Ma.pending,(e=>{e.loading=Me})).addCase(Ma.fulfilled,((e,t)=>{e.loading=Ue,e.purchaseInfo=t.payload,e.error=null})).addCase(Ma.rejected,((e,t)=>{e.loading=He,e.error=t.error.message}))}}).reducer,za=e=>e.purchase.purchaseList,Oa=e=>e.purchase.purchaseList,Ba=e=>e.purchase.purchaseInfo,Ga=[{id:"user_name",label:"User name",minWidth:130},{id:"ticket_name",label:"Ticket name",minWidth:140},{id:"purchase_date",label:"Purchase date",minWidth:100},{id:"ticket_date",label:"Ticket date",minWidth:150},{id:"price_amount",label:"Price",minWidth:150},{id:"ticket_status",label:"Ticket status",minWidth:150},{id:"action",label:"",minWidth:10}],Ja=()=>{const a=s(),i=c(),n=r(za),l=r(Pa),o=r(ka),[d,u]=e.useState(0),[m,p]=e.useState(10),[h,x]=e.useState([]);e.useEffect((()=>{a(Ya())}),[a]),e.useEffect((()=>{n.length>0&&(a(It()),a(pa()))}),[a,n]);const f=e.useMemo((()=>{const e={};return l.forEach((t=>{e[t.id]=t})),e}),[l]),j=e.useMemo((()=>{const e={};return o.forEach((t=>{e[t.user_id]=t})),e}),[o]),g=e.useMemo((()=>n.map((e=>{var a;const s=e.purchase_id,r=f[e.ticket_id],n=j[e.user_id],l=[];return l.push({icon:t.jsx(se,{fontSize:"small",sx:{color:"black"}}),link:s?()=>{i(`${ze.purchasePath}/${s}`)}:null}),{user_name:null==n?void 0:n.name,ticket_name:null==r?void 0:r.name,purchase_date:qe(e.purchase_date).format("DD-MM-YYYY HH:ss"),ticket_date:qe(e.ticket_date).format("DD-MM-YYYY HH:ss"),price_amount:`${e.price_amount} EUR`,ticket_status:(null==(a=Fe.find((t=>t.id===e.ticket_status)))?void 0:a.value)||"",action:t.jsx(Lt,{submenu:l})}}))),[n,f,j]);e.useEffect((()=>{x(g)}),[g]);return t.jsxs(ot,{children:[t.jsx(k,{variant:"h5",children:"Purchase Page"}),t.jsx("br",{}),t.jsx(Ut,{headCells:Ga,rows:h,page:d,rowsPerPage:m,handleChangePage:(e,t)=>{u(t)},handleChangeRowsPerPage:e=>{p(+e.target.value),u(0)}})]})},Ka=()=>{const{id:a}=m(),i=s(),n=c(),l=r(Ba),o=r(Sa),d=r(_a),[u,p]=e.useState(null);return e.useEffect((()=>{i(Ma(a))}),[i,a]),e.useEffect((()=>{if(l){i(ha({user_id:l.user_id})),i(Et(l.ticket_id));const e=Fe.find((e=>e.id===l.ticket_status));p(e)}}),[i,l]),t.jsxs(ot,{children:[t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsx(k,{variant:"h5",children:"Purchase details"}),t.jsx("div",{className:"flex flex-row",children:t.jsx("p",{className:"italic text-cyan-600 cursor-pointer text-sm",onClick:()=>n(ze.purchasePath),children:"Go back Purchase page"})})]}),t.jsxs("div",{className:"grid gap-4 py-3",children:[t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"User name:"}),t.jsx("p",{className:"px-2",children:d.name})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket name:"}),t.jsx("p",{className:"px-2",children:o.name})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Purchase date:"}),t.jsx("p",{className:"px-2",children:qe(l.purchase_date).format("DD-MM-YYYY HH:ss")})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket date:"}),t.jsx("p",{className:"px-2",children:qe(l.ticket_date).format("DD-MM-YYYY HH:ss")})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket price:"}),t.jsxs("p",{className:"px-2",children:[l.price_amount," EUR"]})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Payment status:"}),t.jsx("p",{className:"px-2",children:l.payment_status})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Payment method:"}),t.jsx("p",{className:"px-2",children:l.payment_method})]}),t.jsxs("div",{className:"flex flex-wrap",children:[t.jsx("p",{className:"font-bold",children:"Ticket status:"}),t.jsx("p",{className:"px-2",children:(null==u?void 0:u.value)||"Unknown Status"})," "]})]})]})},Za=[{id:"user_name",label:"User name",minWidth:130},{id:"ticket_name",label:"Ticket name",minWidth:140},{id:"purchase_date",label:"Purchase date",minWidth:100},{id:"ticket_date",label:"Ticket date",minWidth:150},{id:"price_amount",label:"Price",minWidth:150},{id:"ticket_status",label:"Ticket status",minWidth:150},{id:"action",label:"",minWidth:10}],Qa=()=>{const a=s(),i=c(),{institution_id:n}=f(sessionStorage.getItem("token")),l=r(Oa),o=r(Pa),d=r(ka),[u,m]=e.useState(0),[p,h]=e.useState(10),[x,j]=e.useState([]);e.useEffect((()=>{a(Ua(n))}),[a,n]),e.useEffect((()=>{l.length>0&&(a(It()),a(pa()))}),[a,l]);const g=e.useMemo((()=>{const e={};return o.forEach((t=>{e[t.id]=t})),e}),[o]),v=e.useMemo((()=>{const e={};return d.forEach((t=>{e[t.user_id]=t})),e}),[d]),b=e.useMemo((()=>l.map((e=>{var a;const s=e.purchase_id,r=g[e.ticket_id],n=v[e.user_id],l=[];return l.push({icon:t.jsx(se,{fontSize:"small",sx:{color:"black"}}),link:s?()=>{i(`${ze.purchasePathForInstitution}/${s}`)}:null}),{user_name:null==n?void 0:n.name,ticket_name:null==r?void 0:r.name,purchase_date:qe(e.purchase_date).format("DD-MM-YYYY HH:ss"),ticket_date:qe(e.ticket_date).format("DD-MM-YYYY HH:ss"),price_amount:`${e.price_amount} EUR`,ticket_status:(null==(a=Fe.find((t=>t.id===e.ticket_status)))?void 0:a.value)||"",action:t.jsx(Lt,{submenu:l})}}))),[l,g,v]);e.useEffect((()=>{j(b)}),[b]);return t.jsxs(ot,{children:[t.jsx(k,{variant:"h5",children:"Purchase Page"}),t.jsx("br",{}),t.jsx(Ut,{headCells:Za,rows:x,page:u,rowsPerPage:p,handleChangePage:(e,t)=>{m(t)},handleChangeRowsPerPage:e=>{h(+e.target.value),m(0)}})]})},Xa=p([{path:ze.loginPath,element:t.jsx(it,{})},{element:t.jsx(Oe,{}),children:[{path:ze.homePagePath,element:t.jsx(dt,{})},{path:ze.usersPath,element:t.jsx(Ca,{})},{path:ze.userDetailPath,element:t.jsx(ya,{})},{path:ze.editUserPath,element:t.jsx(va,{})},{path:ze.addUsersPath,element:t.jsx(ja,{})},{path:ze.institutionDetailPath,element:t.jsx(Pt,{})},{path:ze.lockerDetailPath,element:t.jsx(na,{})},{element:t.jsx(Be,{permissionRoles:[Le[1].id]}),children:[{path:ze.ticketsPath,element:t.jsx(Da,{})},{path:ze.ticketDetailPath,element:t.jsx(Ia,{})},{path:ze.editTicketPath,element:t.jsx(Ta,{})},{path:ze.addTicketPath,element:t.jsx(qa,{})},{path:ze.institutionsPath,element:t.jsx(zt,{})},{path:ze.editInstitutionPath,element:t.jsx(Nt,{})},{path:ze.addInstitutionPath,element:t.jsx(kt,{})},{path:ze.lockerForInstitutionPath,element:t.jsx(ta,{})},{path:ze.purchasePath,element:t.jsx(Ja,{})},{path:ze.purchaseDetailPath,element:t.jsx(Ka,{})}]},{element:t.jsx(Be,{permissionRoles:[Le[2].id]}),children:[{path:ze.ticketsPathForInstitution,element:t.jsx(La,{})},{path:ze.editTicketPathForInstitution,element:t.jsx($a,{})},{path:ze.addTicketPathForInstitution,element:t.jsx(Va,{})},{path:ze.ticketPathForInstitution,element:t.jsx(Fa,{})},{path:ze.lockersPath,element:t.jsx(oa,{})},{path:ze.addLockerPath,element:t.jsx(sa,{})},{path:ze.editLockerPath,element:t.jsx(ra,{})},{path:ze.purchasePathForInstitution,element:t.jsx(Qa,{})},{path:ze.purchaseDetailPathForInstitution,element:t.jsx(Ka,{})}]}]},{path:"*",element:t.jsx(da,{})},{path:ze.accessDenied,element:t.jsx(Ge,{})}]),ei=me({shadows:pe.map((()=>"none")),palette:{primary:{main:"#222831"}},typography:{},breakpoints:{values:{xs:0,sm:576,md:768,lg:1440,xl:1536}},components:{}});function ti(){return t.jsx(he,{theme:ei,children:t.jsx(De,{children:t.jsx(e.Suspense,{fallback:t.jsx(xe,{}),children:t.jsx(h,{router:Xa})})})})}const ai=ge({reducer:{auth:Xe,ticket:Na,institution:_t,user:ba,locker:Zt,purchase:Ha}});i(document.getElementById("root")).render(t.jsx(e.StrictMode,{children:t.jsx(n,{store:ai,children:t.jsx(ti,{})})}));
